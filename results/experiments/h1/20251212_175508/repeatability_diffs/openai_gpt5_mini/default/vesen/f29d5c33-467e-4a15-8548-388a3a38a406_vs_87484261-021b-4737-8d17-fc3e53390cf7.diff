--- f29d5c33-467e-4a15-8548-388a3a38a406
+++ 87484261-021b-4737-8d17-fc3e53390cf7
@@ -1,28 +1,28 @@
 @@FILE:Dockerfile::Dockerfile
-# Multi-stage build: build the Svelte app with Node, serve with nginx
+# Multi-stage build: build with Node, serve with nginx
 
-FROM node:20-alpine AS builder
+FROM node:18-alpine AS build
 WORKDIR /app
 
-# Install dependencies
+# Install dependencies (including dev deps needed for the build)
 COPY package.json package-lock.json ./
-# copy everything else
+RUN npm ci
+
+# Copy source and build
 COPY . .
-
-RUN npm ci --silent
 RUN npm run build
 
-# Production image
+# Production image - serve static files with nginx
 FROM nginx:stable-alpine
 
 # Remove default nginx website
 RUN rm -rf /usr/share/nginx/html/*
 
-# Copy custom nginx config to serve SPA (fallback to index.html)
+# Copy built static files
+COPY --from=build /app/dist /usr/share/nginx/html/
+
+# Provide nginx config to support SPA history fallback
 COPY nginx.conf /etc/nginx/conf.d/default.conf
-
-# Copy build output
-COPY --from=builder /app/dist /usr/share/nginx/html
 
 EXPOSE 80
 
@@ -50,6 +50,7 @@
           imagePullPolicy: IfNotPresent
           ports:
             - containerPort: 80
+              name: http
           resources:
             requests:
               cpu: "100m"
@@ -60,22 +61,22 @@
           livenessProbe:
             httpGet:
               path: /
-              port: 80
+              port: http
             initialDelaySeconds: 10
-            periodSeconds: 10
+            periodSeconds: 30
           readinessProbe:
             httpGet:
               path: /
-              port: 80
+              port: http
             initialDelaySeconds: 5
-            periodSeconds: 5
+            periodSeconds: 10
 @@FILE:K8s::k8s/ingress.yaml
 apiVersion: networking.k8s.io/v1
 kind: Ingress
 metadata:
   name: vesen-ingress
   annotations:
-    kubernetes.io/ingress.class: "nginx"
+    nginx.ingress.kubernetes.io/rewrite-target: /
 spec:
   rules:
     - host: vesen.rasztabiga.me
@@ -85,14 +86,14 @@
             pathType: Prefix
             backend:
               service:
-                name: vesen
+                name: vesen-service
                 port:
                   number: 80
 @@FILE:K8s::k8s/service.yaml
 apiVersion: v1
 kind: Service
 metadata:
-  name: vesen
+  name: vesen-service
 spec:
   selector:
     app: vesen