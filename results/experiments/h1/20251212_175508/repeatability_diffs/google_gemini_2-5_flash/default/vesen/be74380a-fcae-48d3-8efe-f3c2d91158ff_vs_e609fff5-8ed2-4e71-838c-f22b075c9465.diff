--- be74380a-fcae-48d3-8efe-f3c2d91158ff
+++ e609fff5-8ed2-4e71-838c-f22b075c9465
@@ -1,30 +1,27 @@
 @@FILE:Dockerfile::Dockerfile
-
-FROM node:20-alpine AS builder
+# Stage 1: Build the Svelte application
+FROM node:lts-alpine as builder
 
 WORKDIR /app
 
-COPY package*.json ./
-
-RUN npm ci --omit=dev
+COPY package.json package-lock.json ./
+RUN npm install
 
 COPY . .
-
 RUN npm run build
 
-FROM node:20-alpine
+# Stage 2: Serve the application with Nginx
+FROM nginx:stable-alpine
 
-WORKDIR /app
+COPY --from=builder /app/dist /usr/share/nginx/html
 
-COPY --from=builder /app/dist /app/dist
+# Copy custom Nginx configuration
+COPY nginx.conf /etc/nginx/conf.d/default.conf
 
-RUN npm install -g serve
+EXPOSE 80
 
-EXPOSE 3000
-
-CMD ["serve", "-s", "dist", "-l", "3000"]
-@@FILE:K8s::k8s/deployment.yaml
-
+CMD ["nginx", "-g", "daemon off;"]
+@@FILE:K8s::k8s/vesen-deployment.yaml
 apiVersion: apps/v1
 kind: Deployment
 metadata:
@@ -42,41 +39,38 @@
         app: vesen
     spec:
       containers:
-        - name: vesen
-          image: vesen:latest
-          imagePullPolicy: IfNotPresent
-          ports:
-            - containerPort: 3000
-          resources:
-            requests:
-              memory: "64Mi"
-              cpu: "100m"
-            limits:
-              memory: "128Mi"
-              cpu: "200m"
-@@FILE:K8s::k8s/ingress.yaml
-
+      - name: vesen
+        image: vesen
+        imagePullPolicy: IfNotPresent
+        ports:
+        - containerPort: 80
+        resources:
+          requests:
+            memory: "64Mi"
+            cpu: "100m"
+          limits:
+            memory: "256Mi"
+            cpu: "500m"
+@@FILE:K8s::k8s/vesen-ingress.yaml
 apiVersion: networking.k8s.io/v1
 kind: Ingress
 metadata:
   name: vesen-ingress
   annotations:
-    nginx.ingress.kubernetes.io/ssl-redirect: "false"
-    nginx.ingress.kubernetes.io/use-regex: "true"
+    nginx.ingress.kubernetes.io/rewrite-target: /
 spec:
   rules:
-    - host: "vesen.rasztabiga.me"
-      http:
-        paths:
-          - path: "/"
-            pathType: Prefix
-            backend:
-              service:
-                name: vesen-service
-                port:
-                  number: 80
-@@FILE:K8s::k8s/service.yaml
-
+  - host: vesen.rasztabiga.me
+    http:
+      paths:
+      - path: /
+        pathType: Prefix
+        backend:
+          service:
+            name: vesen-service
+            port:
+              number: 80
+@@FILE:K8s::k8s/vesen-service.yaml
 apiVersion: v1
 kind: Service
 metadata:
@@ -84,10 +78,10 @@
   labels:
     app: vesen
 spec:
+  type: ClusterIP
   selector:
     app: vesen
   ports:
-    - protocol: TCP
-      port: 80
-      targetPort: 3000
-  type: ClusterIP
+  - protocol: TCP
+    port: 80
+    targetPort: 80