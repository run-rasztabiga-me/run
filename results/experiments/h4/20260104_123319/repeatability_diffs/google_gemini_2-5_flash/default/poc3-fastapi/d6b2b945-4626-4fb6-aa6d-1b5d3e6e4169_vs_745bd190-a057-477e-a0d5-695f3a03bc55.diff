--- d6b2b945-4626-4fb6-aa6d-1b5d3e6e4169
+++ 745bd190-a057-477e-a0d5-695f3a03bc55
@@ -6,30 +6,30 @@
 COPY requirements.txt .
 RUN pip install --no-cache-dir -r requirements.txt
 
-COPY ./app ./app
+COPY app ./app
 
 EXPOSE 8000
 
 CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
 @@FILE:Dockerfile::frontend/Dockerfile
-FROM node:16-alpine as builder
+FROM node:16-alpine as build-stage
 
 WORKDIR /app
 
-COPY package.json package-lock.json ./
-RUN npm ci
+COPY package*.json ./
+RUN npm install
 
 COPY . .
 RUN npm run build
 
-FROM nginx:stable-alpine
-
-COPY --from=builder /app/dist /usr/share/nginx/html
+FROM nginx:stable-alpine as production-stage
+
 COPY nginx.conf /etc/nginx/conf.d/default.conf
+COPY --from=build-stage /app/dist /usr/share/nginx/html
 
 EXPOSE 80
 
-CMD ["nginx", "-g", ""daemon off;""]
+CMD ["nginx", "-g", "daemon off;"]
 @@FILE:K8s::k8s/backend-deployment.yaml
 apiVersion: apps/v1
 kind: Deployment
@@ -71,24 +71,24 @@
                   key: POSTGRES_DB
           resources:
             requests:
+              memory: "128Mi"
               cpu: "100m"
-              memory: "128Mi"
             limits:
-              cpu: "500m"
-              memory: "512Mi"
+              memory: "256Mi"
+              cpu: "200m"
           livenessProbe:
             httpGet:
               path: /
               port: 8000
-            initialDelaySeconds: 10
+            initialDelaySeconds: 5
             periodSeconds: 5
           readinessProbe:
             httpGet:
               path: /
               port: 8000
-            initialDelaySeconds: 10
-            periodSeconds: 5
-@@FILE:K8s::k8s/backend-service.yaml
+            initialDelaySeconds: 5
+            periodSeconds: 5
+---
 apiVersion: v1
 kind: Service
 metadata:
@@ -100,7 +100,6 @@
     - protocol: TCP
       port: 8000
       targetPort: 8000
-  type: ClusterIP
 @@FILE:K8s::k8s/frontend-deployment.yaml
 apiVersion: apps/v1
 kind: Deployment
@@ -124,11 +123,11 @@
             - containerPort: 80
           resources:
             requests:
+              memory: "64Mi"
               cpu: "50m"
-              memory: "64Mi"
             limits:
-              cpu: "200m"
-              memory: "256Mi"
+              memory: "128Mi"
+              cpu: "100m"
           livenessProbe:
             httpGet:
               path: /
@@ -141,7 +140,7 @@
               port: 80
             initialDelaySeconds: 5
             periodSeconds: 5
-@@FILE:K8s::k8s/frontend-service.yaml
+---
 apiVersion: v1
 kind: Service
 metadata:
@@ -153,7 +152,6 @@
     - protocol: TCP
       port: 80
       targetPort: 80
-  type: ClusterIP
 @@FILE:K8s::k8s/ingress.yaml
 apiVersion: networking.k8s.io/v1
 kind: Ingress
@@ -162,6 +160,7 @@
   annotations:
     nginx.ingress.kubernetes.io/rewrite-target: /$2
 spec:
+  ingressClassName: nginx
   rules:
     - host: poc3-fastapi.rasztabiga.me
       http:
@@ -180,18 +179,6 @@
                 name: backend
                 port:
                   number: 8000
-@@FILE:K8s::k8s/postgres-pvc.yaml
-apiVersion: v1
-kind: PersistentVolumeClaim
-metadata:
-  name: postgres-pvc
-spec:
-  accessModes:
-    - ReadWriteOnce
-  resources:
-    requests:
-      storage: 1Gi
-  storageClassName: microk8s-hostpath
 @@FILE:K8s::k8s/postgres-secret.yaml
 apiVersion: v1
 kind: Secret
@@ -199,22 +186,9 @@
   name: postgres-secret
 type: Opaque
 data:
-  POSTGRES_USER: dXNlcg==
-  POSTGRES_PASSWORD: cGFzc3dvcmQ=
-  POSTGRES_DB: ZGJuYW1l
-@@FILE:K8s::k8s/postgres-service.yaml
-apiVersion: v1
-kind: Service
-metadata:
-  name: postgres
-spec:
-  selector:
-    app: postgres
-  ports:
-    - protocol: TCP
-      port: 5432
-      targetPort: 5432
-  type: ClusterIP
+  POSTGRES_USER: cG9zdGdyZXN1c2Vy
+  POSTGRES_PASSWORD: cG9zdGdyZXNwYXNzd29yZA==
+  POSTGRES_DB: bm90ZXNkYg==
 @@FILE:K8s::k8s/postgres-statefulset.yaml
 apiVersion: apps/v1
 kind: StatefulSet
@@ -240,21 +214,32 @@
             - secretRef:
                 name: postgres-secret
           volumeMounts:
-            - name: postgres-storage
+            - name: postgres-data
               mountPath: /var/lib/postgresql/data
           resources:
             requests:
-              cpu: "100m"
               memory: "256Mi"
+              cpu: "250m"
             limits:
+              memory: "512Mi"
               cpu: "500m"
-              memory: "512Mi"
   volumeClaimTemplates:
     - metadata:
-        name: postgres-storage
+        name: postgres-data
       spec:
         accessModes: ["ReadWriteOnce"]
         resources:
           requests:
             storage: 1Gi
-        storageClassName: microk8s-hostpath
+---
+apiVersion: v1
+kind: Service
+metadata:
+  name: postgres
+spec:
+  selector:
+    app: postgres
+  ports:
+    - protocol: TCP
+      port: 5432
+      targetPort: 5432