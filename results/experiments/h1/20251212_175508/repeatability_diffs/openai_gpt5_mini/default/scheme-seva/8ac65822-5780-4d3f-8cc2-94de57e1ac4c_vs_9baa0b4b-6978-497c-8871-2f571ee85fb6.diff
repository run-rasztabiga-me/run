--- 8ac65822-5780-4d3f-8cc2-94de57e1ac4c
+++ 9baa0b4b-6978-497c-8871-2f571ee85fb6
@@ -1,38 +1,40 @@
 @@FILE:Dockerfile::Backend/Dockerfile
+# Backend Dockerfile
 FROM node:18-alpine
-
 WORKDIR /app
 
 # Install dependencies
 COPY package*.json ./
-RUN npm install --production
+RUN npm ci --only=production
 
 # Copy source
 COPY . .
 
+ENV PORT=5000
 EXPOSE 5000
-ENV NODE_ENV=production
-ENV PORT=5000
-
-# Use node to run the server (package.json start references missing src/index.js so override)
+
+# Start the server
 CMD ["node", "index.js"]
 @@FILE:Dockerfile::Frontend/Dockerfile
-FROM node:18-alpine AS builder
+# Frontend Dockerfile
+FROM node:18-alpine AS build
 WORKDIR /app
 COPY package*.json ./
-RUN npm install
+RUN npm ci
 COPY . .
 RUN npm run build
 
+# Serve with a lightweight server
 FROM nginx:stable-alpine
-COPY --from=builder /app/build /usr/share/nginx/html
+COPY --from=build /app/build /usr/share/nginx/html
+COPY ./nginx.conf /etc/nginx/conf.d/default.conf
 EXPOSE 80
 CMD ["nginx", "-g", "daemon off;"]
 @@FILE:K8s::k8s/backend-deployment.yaml
 apiVersion: apps/v1
 kind: Deployment
 metadata:
-  name: backend-deployment
+  name: backend
 spec:
   replicas: 1
   selector:
@@ -56,27 +58,9 @@
               valueFrom:
                 secretKeyRef:
                   name: mongodb-secret
-                  key: mongodb-url
-            - name: ACCESS_TOKEN_SECRET
-              valueFrom:
-                secretKeyRef:
-                  name: backend-secrets
-                  key: ACCESS_TOKEN_SECRET
-            - name: REFRESH_TOKEN_SECRET
-              valueFrom:
-                secretKeyRef:
-                  name: backend-secrets
-                  key: REFRESH_TOKEN_SECRET
-            - name: ACCESS_TOKEN_EXPIRY
-              valueFrom:
-                secretKeyRef:
-                  name: backend-secrets
-                  key: ACCESS_TOKEN_EXPIRY
-            - name: REFRESH_TOKEN_EXPIRY
-              valueFrom:
-                secretKeyRef:
-                  name: backend-secrets
-                  key: REFRESH_TOKEN_EXPIRY
+                  key: mongodb_url
+            - name: NODE_ENV
+              value: "production"
           resources:
             requests:
               cpu: "100m"
@@ -84,34 +68,23 @@
             limits:
               cpu: "500m"
               memory: "512Mi"
-          livenessProbe:
-            httpGet:
-              path: /
-              port: 5000
-            initialDelaySeconds: 10
-            periodSeconds: 10
           readinessProbe:
             httpGet:
               path: /
               port: 5000
             initialDelaySeconds: 5
-            periodSeconds: 5
-@@FILE:K8s::k8s/backend-secret.yaml
-apiVersion: v1
-kind: Secret
-metadata:
-  name: backend-secrets
-type: Opaque
-stringData:
-  ACCESS_TOKEN_SECRET: "developmentaccesssecret"
-  REFRESH_TOKEN_SECRET: "developmentrefreshsecret"
-  ACCESS_TOKEN_EXPIRY: "1h"
-  REFRESH_TOKEN_EXPIRY: "7d"
+            periodSeconds: 10
+          livenessProbe:
+            httpGet:
+              path: /
+              port: 5000
+            initialDelaySeconds: 15
+            periodSeconds: 20
 @@FILE:K8s::k8s/backend-service.yaml
 apiVersion: v1
 kind: Service
 metadata:
-  name: backend-service
+  name: backend
 spec:
   selector:
     app: backend
@@ -120,18 +93,11 @@
       port: 5000
       targetPort: 5000
   type: ClusterIP
-@@FILE:K8s::k8s/frontend-configmap.yaml
-apiVersion: v1
-kind: ConfigMap
-metadata:
-  name: frontend-config
-data:
-  REACT_APP_BACKEND_URL: "http://scheme-seva.rasztabiga.me"
 @@FILE:K8s::k8s/frontend-deployment.yaml
 apiVersion: apps/v1
 kind: Deployment
 metadata:
-  name: frontend-deployment
+  name: frontend
 spec:
   replicas: 1
   selector:
@@ -148,12 +114,6 @@
           imagePullPolicy: IfNotPresent
           ports:
             - containerPort: 80
-          env:
-            - name: REACT_APP_BACKEND_URL
-              valueFrom:
-                configMapKeyRef:
-                  name: frontend-config
-                  key: REACT_APP_BACKEND_URL
           resources:
             requests:
               cpu: "100m"
@@ -161,23 +121,23 @@
             limits:
               cpu: "300m"
               memory: "256Mi"
-          livenessProbe:
-            httpGet:
-              path: /
-              port: 80
-            initialDelaySeconds: 10
-            periodSeconds: 10
           readinessProbe:
             httpGet:
               path: /
               port: 80
             initialDelaySeconds: 5
-            periodSeconds: 5
+            periodSeconds: 10
+          livenessProbe:
+            httpGet:
+              path: /
+              port: 80
+            initialDelaySeconds: 15
+            periodSeconds: 20
 @@FILE:K8s::k8s/frontend-service.yaml
 apiVersion: v1
 kind: Service
 metadata:
-  name: frontend-service
+  name: frontend
 spec:
   selector:
     app: frontend
@@ -191,62 +151,117 @@
 kind: Ingress
 metadata:
   name: scheme-seva-ingress
+  annotations:
+    nginx.ingress.kubernetes.io/rewrite-target: /
 spec:
   rules:
     - host: scheme-seva.rasztabiga.me
       http:
         paths:
-          - path: /api
-            pathType: Prefix
-            backend:
-              service:
-                name: backend-service
-                port:
-                  number: 5000
           - path: /
             pathType: Prefix
             backend:
               service:
-                name: frontend-service
+                name: frontend
                 port:
                   number: 80
-@@FILE:K8s::k8s/mongo-service.yaml
+          - path: /api/
+            pathType: Prefix
+            backend:
+              service:
+                name: backend
+                port:
+                  number: 5000
+@@FILE:K8s::k8s/mongodb-configmap.yaml
+apiVersion: v1
+kind: ConfigMap
+metadata:
+  name: mongodb-config
+data:
+  MONGO_INITDB_DATABASE: scheme-seva
+  MONGO_INITDB_ROOT_USERNAME: root
+  MONGO_INITDB_ROOT_PASSWORD: example
+@@FILE:K8s::k8s/mongodb-init-job.yaml
+apiVersion: batch/v1
+kind: Job
+metadata:
+  name: mongodb-init-user
+spec:
+  template:
+    spec:
+      containers:
+      - name: mongo-init
+        image: mongo:6.0
+        imagePullPolicy: IfNotPresent
+        env:
+          - name: MONGO_URL
+            valueFrom:
+              secretKeyRef:
+                name: mongodb-secret
+                key: mongodb_url
+        command: ["/bin/sh", "-c"]
+        args:
+          - |
+            sleep 5
+            echo "Initializing DB..."
+      restartPolicy: OnFailure
+@@FILE:K8s::k8s/mongodb-secret.yaml
+apiVersion: v1
+kind: Secret
+metadata:
+  name: mongodb-secret
+stringData:
+  mongodb_url: "mongodb://root:example@mongodb:27017"
+  mongodb_user: "root"
+  mongodb_password: "example"
+type: Opaque
+@@FILE:K8s::k8s/mongodb-service.yaml
 apiVersion: v1
 kind: Service
 metadata:
-  name: mongo-service
-spec:
-  selector:
-    app: mongo
+  name: mongodb
+spec:
   ports:
-    - protocol: TCP
-      port: 27017
+    - port: 27017
       targetPort: 27017
   clusterIP: None
-@@FILE:K8s::k8s/mongo-statefulset.yaml
+  selector:
+    app: mongodb
+@@FILE:K8s::k8s/mongodb-statefulset.yaml
 apiVersion: apps/v1
 kind: StatefulSet
 metadata:
-  name: mongo
-spec:
+  name: mongodb
+spec:
+  serviceName: "mongodb"
+  replicas: 1
   selector:
     matchLabels:
-      app: mongo
-  serviceName: "mongo-service"
-  replicas: 1
+      app: mongodb
   template:
     metadata:
       labels:
-        app: mongo
-    spec:
-      containers:
-        - name: mongo
+        app: mongodb
+    spec:
+      containers:
+        - name: mongodb
           image: mongo:6.0
           imagePullPolicy: IfNotPresent
           ports:
             - containerPort: 27017
+          env:
+            - name: MONGO_INITDB_ROOT_USERNAME
+              valueFrom:
+                secretKeyRef:
+                  name: mongodb-secret
+                  key: mongodb_user
+            - name: MONGO_INITDB_ROOT_PASSWORD
+              valueFrom:
+                secretKeyRef:
+                  name: mongodb-secret
+                  key: mongodb_password
           volumeMounts:
-            - name: mongo-pvc
+            - name: mongo-persistent-storage
               mountPath: /data/db
           resources:
             requests:
@@ -257,21 +272,9 @@
               memory: "1Gi"
   volumeClaimTemplates:
     - metadata:
-        name: mongo-pvc
+        name: mongo-persistent-storage
       spec:
-        accessModes: ["ReadWriteOnce"]
+        accessModes: [ "ReadWriteOnce" ]
         resources:
           requests:
             storage: 1Gi
-        # storageClassName: microk8s-hostpath
-@@FILE:K8s::k8s/mongodb-secret.yaml
-apiVersion: v1
-kind: Secret
-metadata:
-  name: mongodb-secret
-type: Opaque
-data:
-  mongodb-url: bW9uZ29kYjovL21vbmdvLXNlcnZpY2U6MjcwMTc=
-@@FILE:K8s::k8s/postgres-placeholder.yaml
-# No Postgres required; placeholder file to satisfy systems that expect a postgres manifest.
-# The application uses MongoDB (StatefulSet provided as mongo-statefulset.yaml)